{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { useEffect, useState } from \"react\";\nimport { Text, View } from \"../components/Themed\";\nimport firestore from \"@react-native-firebase/firestore\";\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar _Dimensions$get = Dimensions.get(\"window\"),\n    width = _Dimensions$get.width;\n\nvar qrSize = width * 0.7;\nexport default function TabOneScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasPermission = _useState2[0],\n      setHasPermission = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      scanned = _useState4[0],\n      setScanned = _useState4[1];\n\n  var getuser = function _callee() {\n    var users;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(firestore().collection(\"Users\").get());\n\n          case 2:\n            users = _context.sent;\n            return _context.abrupt(\"return\", users);\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      restaurantsList = _useState6[0],\n      setRestaurantsList = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      errorMessage = _useState8[0],\n      setErrorMessage = _useState8[1];\n\n  var getRestaurants = function _callee2() {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(firestore().collection(\"Products\").where(\"available\", \"==\", true).get().then(function (querySnapshot) {\n              querySnapshot.forEach(function (snapshot) {\n                var data = _objectSpread({\n                  id: snapshot.id\n                }, snapshot.data());\n\n                setRestaurantsList(data.name);\n              });\n            }));\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    var unsubscribe = navigation.addListener(\"focus\", function () {\n      setHasPermission(null);\n\n      (function _callee3() {\n        var _await$BarCodeScanner, status;\n\n        return _regeneratorRuntime.async(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _regeneratorRuntime.awrap(BarCodeScanner.requestPermissionsAsync());\n\n              case 2:\n                _await$BarCodeScanner = _context3.sent;\n                status = _await$BarCodeScanner.status;\n                setHasPermission(status === \"granted\");\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      })();\n    });\n    return unsubscribe;\n  }, [navigation]);\n\n  var handleBarCodeScanned = function _callee4(_ref2) {\n    var type, data;\n    return _regeneratorRuntime.async(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            type = _ref2.type, data = _ref2.data;\n            setScanned(true);\n            navigation.navigate(\"Add\", {\n              data: data,\n              type: type\n            });\n\n          case 3:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  if (hasPermission === null) {\n    return _jsx(Text, {\n      children: \"Requesting for camera permission\"\n    });\n  }\n\n  if (hasPermission === false) {\n    return _jsx(Text, {\n      children: \"No access to camera\"\n    });\n  }\n\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsxs(BarCodeScanner, {\n      onBarCodeScanned: scanned ? undefined : handleBarCodeScanned,\n      style: [StyleSheet.absoluteFillObject, styles.camera],\n      children: [_jsx(Text, {\n        style: styles.description,\n        children: \"Scan your QR code\"\n      }), _jsx(Image, {\n        style: styles.qr,\n        source: require(\"../assets/images/QR.png\")\n      }), _jsx(Text, {\n        onPress: function onPress() {\n          return setScanned(false);\n        },\n        style: styles.cancel,\n        children: \"Scan\"\n      })]\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  camera: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  container: {\n    flex: 1,\n    contentPadding: 0,\n    padding: 0,\n    paddingHorizontal: 0,\n    paddingLeft: 0,\n    paddingStart: 0,\n    marginHorizontal: 0,\n    marginLeft: 0,\n    marginStart: 0\n  },\n  qr: {\n    marginTop: \"20%\",\n    marginBottom: \"20%\",\n    width: qrSize,\n    height: qrSize\n  },\n  description: {\n    fontSize: width * 0.09,\n    marginTop: \"10%\",\n    textAlign: \"center\",\n    width: \"70%\",\n    color: \"white\"\n  },\n  cancel: {\n    fontSize: width * 0.07,\n    textAlign: \"center\",\n    width: \"30%\",\n    color: \"white\",\n    backgroundColor: \"green\",\n    padding: 2,\n    borderRadius: 15\n  }\n});","map":{"version":3,"names":["useEffect","useState","Text","View","firestore","BarCodeScanner","Dimensions","get","width","qrSize","TabOneScreen","navigation","hasPermission","setHasPermission","scanned","setScanned","getuser","collection","users","restaurantsList","setRestaurantsList","errorMessage","setErrorMessage","getRestaurants","where","then","querySnapshot","forEach","snapshot","data","id","name","unsubscribe","addListener","requestPermissionsAsync","status","handleBarCodeScanned","type","navigate","styles","container","undefined","StyleSheet","absoluteFillObject","camera","description","qr","require","cancel","create","flex","justifyContent","alignItems","contentPadding","padding","paddingHorizontal","paddingLeft","paddingStart","marginHorizontal","marginLeft","marginStart","marginTop","marginBottom","height","fontSize","textAlign","color","backgroundColor","borderRadius"],"sources":["C:/Users/alija/Documents/react-native/Supermarket/screens/TabOneScreen.tsx"],"sourcesContent":["import { StyleSheet, Dimensions, TouchableOpacity, Image } from \"react-native\";\nimport { useEffect, useState } from \"react\";\nimport EditScreenInfo from \"../components/EditScreenInfo\";\nimport { Text, View } from \"../components/Themed\";\nimport { RootTabScreenProps } from \"../types\";\n\nimport firestore from \"@react-native-firebase/firestore\";\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\n\nconst { width } = Dimensions.get(\"window\");\nconst qrSize = width * 0.7;\n\nexport default function TabOneScreen({\n  navigation,\n}: RootTabScreenProps<\"TabOne\">) {\n  const [hasPermission, setHasPermission] = useState(null);\n  const [scanned, setScanned] = useState(true);\n\n  const getuser = async () => {\n    const users = await firestore().collection(\"Users\").get();\n    return users;\n  };\n\n  const [restaurantsList, setRestaurantsList] = useState([]); //Initialise restaurant list with setter\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  const getRestaurants = async () => {\n    //const list = [];\n    //var snapshot = await firestore().collection(\"Users\").get();\n    await firestore()\n      .collection(\"Products\")\n      .where(\"available\", \"==\", true)\n      .get()\n      .then((querySnapshot) => {\n        querySnapshot.forEach((snapshot) => {\n          let data = { id: snapshot.id, ...snapshot.data() };\n          setRestaurantsList(data.name);\n        });\n      });\n    //console.log(snapshot);\n    // .doc(\"gmpXuNUNvdvbfB14w2ZF\")\n  };\n\n  //Call when component is rendered\n  useEffect(() => {\n    //getRestaurants();\n    const unsubscribe = navigation.addListener(\"focus\", () => {\n      // do something - for example: reset states, ask for camera permission\n      setHasPermission(null);\n      (async () => {\n        const { status } = await BarCodeScanner.requestPermissionsAsync();\n        setHasPermission(status === \"granted\");\n      })();\n    });\n\n    // Return the function to unsubscribe from the event so it gets removed on unmount\n    return unsubscribe;\n  }, [navigation]);\n\n  const handleBarCodeScanned = async ({ type, data }) => {\n    setScanned(true);\n    //     setDoc(doc(db, \"products\", \"fsggrtj2\"), {\n    //   name: \"Los Angeles\",\n    //   state: \"CA\",\n    //   country: \"USA\"\n    // });\n    // await firestore()\n    //   .collection(\"Products\")\n    //   .add({\n    //     name: \"test\",\n    //     available: true,\n    //     productid: data,\n    //     idtype: type,\n    //     price: 1.3,\n    //     quantity: 55,\n    //   })\n    //   .then(() => {\n    //     console.log(\"User added!\");\n    //   });\n    navigation.navigate(\"Add\", { data: data, type: type });\n    //alert(data);\n  };\n\n  if (hasPermission === null) {\n    return <Text>Requesting for camera permission</Text>;\n  }\n  if (hasPermission === false) {\n    return <Text>No access to camera</Text>;\n  }\n  return (\n    <View style={styles.container}>\n      <BarCodeScanner\n        onBarCodeScanned={scanned ? undefined : handleBarCodeScanned}\n        style={[StyleSheet.absoluteFillObject, styles.camera]}\n      >\n        <Text style={styles.description}>Scan your QR code</Text>\n        <Image style={styles.qr} source={require(\"../assets/images/QR.png\")} />\n        <Text onPress={() => setScanned(false)} style={styles.cancel}>\n          Scan\n        </Text>\n      </BarCodeScanner>\n      {/* {scanned && <TouchableOpacity\n        onPress={() => setScanned(false)} \n      >\n        <Text>Tap to Scan Again</Text>\n      </TouchableOpacity>} */}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  camera: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  container: {\n    flex: 1,\n    contentPadding: 0,\n    padding: 0,\n    paddingHorizontal: 0,\n    paddingLeft: 0,\n    paddingStart: 0,\n    marginHorizontal: 0,\n    marginLeft: 0,\n    marginStart: 0,\n  },\n  qr: {\n    marginTop: \"20%\",\n    marginBottom: \"20%\",\n    width: qrSize,\n    height: qrSize,\n  },\n  description: {\n    fontSize: width * 0.09,\n    marginTop: \"10%\",\n    textAlign: \"center\",\n    width: \"70%\",\n    color: \"white\",\n  },\n  cancel: {\n    fontSize: width * 0.07,\n    textAlign: \"center\",\n    width: \"30%\",\n    color: \"white\",\n    backgroundColor: \"green\",\n    padding: 2,\n    borderRadius: 15,\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}